// Ceci est un commentaire, ils commencent tous par //
// Le CSML ignore les commentaires, ils sont utiles pour les dÃ©veloppeurs :3

// Un chatbot commence toujours par l'Ã©tape "start" ci-dessous
start:
  // On va saluer l'utilisateur avec la commande `say`
  goto affichage
  say "Salut!"
  say Typing(3000)
  say "Je suis ton guide parisien, je suis incollable quand il s'agit de trouver les femmes illustres parisiennes! ğŸ¤™"
  // On peut poser une question Ã  l'utilisateur et donner des choix de boutons
  say Question("Tu es prÃªt.e ?",
    buttons=[
      // Vous remarquerez qu'on utilise le mot clÃ© "as", il permet au csml de se souvenir de ce bouton
      // pour s'en servir plus tard (dans le if)
      Button("Oui let's gooo! ğŸ”¥") as btnOui,
      Button("Pas tout Ã  fait ğŸ˜•") as btnNon
    ])
  // "hold" indique au chatbot qu'il doit attendre une rÃ©ponse de l'utilisateur (une phrase ou un click)
	hold
  // La rÃ©ponse de l'utilisateur va arriver dans la variable `event`
  // Dans le cas prÃ©sent on va voir ce que contient cette variable en demandant au csml si event "match" le bouton Oui
  if (event match btnOui) {
    say "Super allons-y!"
  } else {
    say "Pas de soucis, je me tiens Ã  ta disposition!"
    goto end
  }
  
  
// ############################################################
// Ã€ toi de jouer maintenant, il va falloir remplir les trous !
// ############################################################
// Exercice 0 : Efface la ligne ci-dessous (ligne 35) pour commencer le workshop 
/*

// 1 - Ã‰cris la question que va poser le chatbot Ã  l'utilisateur
  say Question("????",
	buttons=[
    Button("77 Illustres Parisiennes"),
    Button("Sportives"),
    Button("Cheffes"),
    Button("ComÃ©diennes"),
    Button("Artistes"),
    Button("Scientifiques"),
    Button("Politiques"),
    Button("Femmes de lettres")
		])
  // 2 - Indique au chatbot d'attendre la rÃ©ponse de l'utilisateur ici
  ????
  // 3 - Indique au chatbot qu'il doit se souvenir de la rÃ©ponse de l'utilisateur
  // en la mettant dans une variable (une boite) qu'on appelera  "le_genre"
  ???? categorie = event
  // 4 - Le chatboit doit se rendre Ã  l'Ã©tape arrondissement
  ???? arrondissemnt
  
arrondissemnt:
  // 5 - Nous voulons faire sembalnt d'Ã©crire pendant 3 secondes
  // 6 - Il manque le mot clÃ© pour poser une question
  say ????("Quel arrondissement souhaites-tu explorer ?",
	buttons=[
		Button("Tous ğŸ§")
		])
  hold
  // 7 - Comment se souvenir de la saisie de l'utilisateur dans la variable `arrondissement` ?
  remember ???? ???? ????
  
  // 8 - Indique au chatbot qu'il doit se rendre Ã  l'Ã©tape quel_tri
  ???? ????

// 9 - Il manque le nom de l'Ã©tape ci-dessous
????:
  if (arrondissement.is_number() == false) remember arrondissement = "any"
  do res = App("femmes_illustres", category=categorie, district=arrondissement)
  do cards = []
  if (res.length() == 0) {
    say "Je ne connais pas de femme illustre {{categorie}} dans cette zone, dÃ©solÃ© ğŸ˜”"
  }
  foreach (val, index) in res {
    do newCard = Card(
      title=val.name,
      subtitle=val.address,
      image_url=val.thumb_url,
      buttons=[Button("En savoir plus", payload=val.objectid.to_string())]
    )
    if (index < 6) do cards.push(newCard)
  }
  say Carousel(
    cards = cards
  )
  goto moreInfos

moreInfos:
  hold
  if (event.is_number() == false) goto start
  do f = App("femmes_illustres", objectid=event)
  if (!f) goto start
  say Image(f.thumb_url)
  say Typing(4000)
  say "{{f.name}} - {{f.address}}"
  say Typing(4000)
  if (f.desc1) {
  say Typing(4000)
    say "{{f.desc1}}"
  }
  if (f.desc2) {
  say Typing(4000)
    say "{{f.desc2}}"
  }
  if (f.desc3) {
  say Typing(4000)
    say "{{f.desc3}}"
  }
  if (f.desc4) {
  say Typing(4000)
    say "{{f.desc4}}"
  }
  if (f.geo_shape)
    say Url("https://www.google.fr/maps/search/{{f.geo_shape.coordinates[1]}},{{f.geo_shape.coordinates[0]}}", text="Explorer dans Google Maps", hide_url=true)
  goto moreInfos

